events {
  worker_connections 1024;
}

http {
  # Importing configurations from other files
  include /etc/nginx/mime.types;
  include /etc/nginx/conf.d/*.conf;

  # Server block for the AI Guardian application
  server {
    listen 80;
    server_name ai-guardian.com;

    # Defining the root directory for the application
    root /var/www/html;

    # Index files to serve by default
    index index.html index.htm index.nginx-debian.html;

    # Location block for the API gateway
    location /api {
      try_files $uri @proxy;
      error_page 404 = @proxy;
    }

    # Proxying requests to the Rust-based core
    location @proxy {
      proxy_pass http://localhost:8080;
      proxy_set_header Host $host;
      proxy_set_header X-Real-IP $remote_addr;
    }

    # Error handling
    error_page 500 502 503 504 /50x.html;
    location = /50x.html {
      root /usr/share/nginx/html;
    }
  }
}
